<!DOCTYPE html>
<html lang="sk">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dochádzka – Hostia</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <h1>HOSTIA</h1>

  <!-- SCROLLABLE TABLE CONTAINER -->
  <div class="table-scroll">
    <table>
      <thead>
        <tr>
          <th></th>
          <th>Meno</th>
          <th>Číslo</th>
        </tr>
      </thead>
      <tbody id="playersBody">
        <!-- players injected here -->
      </tbody>
    </table>
  </div>

  <!-- FIXED ACTION BUTTON -->
  <button id="continueBtn" class="action-btn" disabled>
    Pokračovať
  </button>

  <script>
    const params = new URLSearchParams(window.location.search);
    const homeTeamId = params.get("home");
    const awayTeamId = params.get("away");

    const tbody = document.getElementById("playersBody");
    const continueBtn = document.getElementById("continueBtn");

    function updateButtonState() {
      const checked =
        document.querySelectorAll('input[type="checkbox"]:checked');
      continueBtn.disabled = checked.length < 5;
    }

    async function loadPlayers() {
      const res = await fetch(
        "https://lucifer21sk.pythonanywhere.com/players/" + awayTeamId
      );
      const players = await res.json();

      tbody.innerHTML = "";

      players.forEach(player => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>
            <input type="checkbox" class="player-checkbox">
          </td>
          <td>${player.name}</td>
          <td>${player.number}</td>
        `;
        tbody.appendChild(tr);
      });

      document
        .querySelectorAll(".player-checkbox")
        .forEach(cb =>
          cb.addEventListener("change", updateButtonState)
        );
    }

    continueBtn.addEventListener("click", () => {
      window.location.href =
        `live_match.html?home=${homeTeamId}&away=${awayTeamId}`;
    });

    loadPlayers();
  </script>

</body>
</html>
